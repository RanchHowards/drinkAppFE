(this["webpackJsonpdrink-app"]=this["webpackJsonpdrink-app"]||[]).push([[0],{81:function(e,t,n){},83:function(e,t,n){},90:function(e,t,n){"use strict";n.r(t),n.d(t,"typeDefs",(function(){return $e}));var c,a,r,i,s,l,o,d,j,u,b,v,O,h,x,m,p=n(8),f=n(16),g=n(3),y=n(65),k=n.n(y),N=(n(81),n(38)),E=n.n(N),D=n(45),C=n(22),S=n(5),w=n(13),I=(n(83),n(102)),$=n(104),B=n(101),T=(Object(B.a)(c||(c=Object(f.a)(["\n  fragment UserFields on User {\n    username\n    pic\n    id\n  }\n"]))),Object(B.a)(a||(a=Object(f.a)(["\n  fragment EventFields on Event {\n    title\n    eventType\n    eventPic\n    location\n    description\n    max\n    maxGuests\n    eventDate\n    createdAt\n    id\n  }\n"])))),A=Object(B.a)(r||(r=Object(f.a)(["\n  fragment NestedEventFields on Event {\n    title\n    eventType\n    eventPic\n    location\n    attendees {\n      username\n      pic\n      id\n      drink\n    }\n    host {\n      username\n      pic\n      id\n      drink\n    }\n    comments {\n      comment\n      author {\n        username\n        id\n        pic\n      }\n      id\n    }\n    description\n    max\n    maxGuests\n    eventDate\n    createdAt\n    id\n  }\n"]))),L=Object(B.a)(i||(i=Object(f.a)(["\n  query {\n    allEvents {\n      ...NestedEventFields\n    }\n  }\n  ","\n"])),A),P=(Object(B.a)(s||(s=Object(f.a)(["\n  query {\n    allUsers {\n      username\n    }\n  }\n"]))),Object(B.a)(l||(l=Object(f.a)(["\n  mutation addEvent(\n    $title: String!\n    $eventType: String\n    $eventPic: String\n    $location: String\n    $eventDate: Date\n    $description: String\n    $max: Boolean\n    $maxGuests: Int\n  ) {\n    addEvent(\n      title: $title\n      eventType: $eventType\n      eventPic: $eventPic\n      location: $location\n      eventDate: $eventDate\n      description: $description\n      max: $max\n      maxGuests: $maxGuests\n    ) {\n      ...EventFields\n    }\n  }\n  ","\n"])),T)),R=Object(B.a)(o||(o=Object(f.a)(["\n  mutation editEvent(\n    $title: String!\n    $eventType: String\n    $eventPic: String\n    $location: String\n    $eventDate: Date\n    $description: String\n    $max: Boolean\n    $maxGuests: Int\n    $eventId: ID!\n  ) {\n    editEvent(\n      title: $title\n      eventType: $eventType\n      eventPic: $eventPic\n      location: $location\n      eventDate: $eventDate\n      description: $description\n      max: $max\n      maxGuests: $maxGuests\n      eventId: $eventId\n    ) {\n      ...EventFields\n      id\n    }\n  }\n  ","\n"])),T),q=Object(B.a)(d||(d=Object(f.a)(["\n  mutation joinEvent($userId: ID!, $eventId: ID!) {\n    joinEvent(userId: $userId, eventId: $eventId) {\n      title\n      attendees {\n        username\n        id\n      }\n      id\n    }\n  }\n"]))),G=Object(B.a)(j||(j=Object(f.a)(["\n  mutation leaveEvent($userId: ID!, $eventId: ID!) {\n    leaveEvent(userId: $userId, eventId: $eventId) {\n      title\n      attendees {\n        username\n        id\n      }\n      id\n    }\n  }\n"]))),F=Object(B.a)(u||(u=Object(f.a)(["\n  query findEvent($eventId: ID!) {\n    findEvent(eventId: $eventId) {\n      ...NestedEventFields\n    }\n  }\n  ","\n"])),A),Q=Object(B.a)(b||(b=Object(f.a)(["\n  mutation deleteEvent($eventId: ID!) {\n    deleteEvent(eventId: $eventId) {\n      id\n    }\n  }\n"]))),U=Object(B.a)(v||(v=Object(f.a)(["\n  mutation createUser(\n    $username: String!\n    $password: String!\n    $drink: String\n    $pic: String\n  ) {\n    createUser(\n      username: $username\n      password: $password\n      drink: $drink\n      pic: $pic\n    ) {\n      value\n      user {\n        username\n        pic\n        drink\n        id\n        myEvents {\n          ...EventFields\n        }\n      }\n    }\n  }\n  ","\n"])),T),Y=Object(B.a)(O||(O=Object(f.a)(["\n  mutation login($username: String!, $password: String!) {\n    login(username: $username, password: $password) {\n      value\n      user {\n        username\n        id\n        drink\n        pic\n        myEvents {\n          ...EventFields\n          id\n        }\n      }\n    }\n  }\n  ","\n"])),T),M=Object(B.a)(h||(h=Object(f.a)(["\n  query {\n    me {\n      username\n      id\n      drink\n      pic\n      myEvents {\n        ...EventFields\n        id\n      }\n    }\n  }\n  ","\n"])),T),H=Object(B.a)(x||(x=Object(f.a)(["\n  query IsUserLoggedIn {\n    isLoggedIn @client\n  }\n"]))),z=Object(B.a)(m||(m=Object(f.a)(["\n  mutation createComment($eventId: ID!, $comment: String!, $inResponseTo: ID) {\n    createComment(\n      eventId: $eventId\n      comment: $comment\n      inResponseTo: $inResponseTo\n    ) {\n      comment\n      id\n      author {\n        username\n        id\n        pic\n      }\n    }\n  }\n"]))),J=n(12),W=n(0),K=function(e){var t=e.event,n=e.setNotify,c=Object(I.a)(H).data,a=Object(I.a)(M),r=Object($.a)(q,{update:function(e,t){try{var n=t.data.joinEvent,c=e.readQuery({query:L});e.writeQuery({query:L,data:Object(p.a)(Object(p.a)({},c),{},{allEvents:c.allEvents.filter((function(e){return e.id!==n.id?e:n}))})})}catch(a){throw new Error(a.message)}}}),i=Object(S.a)(r,1)[0],s=Object($.a)(G,{update:function(e,t){try{var n=t.data.leaveEvent,c=e.readQuery({query:L});e.writeQuery({query:L,data:Object(p.a)(Object(p.a)({},c),{},{allEvents:c.allEvents.filter((function(e){return e.id!==n.id?e:n}))})})}catch(a){throw new Error(a.message)}}}),l=Object(S.a)(s,1)[0];if(a.loading)return Object(W.jsx)("div",{children:"LOADING"});if(a.error)return Object(W.jsx)("div",{children:a.error.message});var o=a.data.me,d=!t.attendees.every((function(e){return(null===e||void 0===e?void 0:e.id)!==(null===o||void 0===o?void 0:o.id)}));return c.isLoggedIn?(null===o||void 0===o?void 0:o.id)===t.host.id?Object(W.jsx)(J.b,{to:"/editevent/".concat(t.id),children:Object(W.jsx)("button",{className:"button edit-button",children:"Edit"})}):!t.max||t.attendees.length<parseInt(t.maxGuests)?d?Object(W.jsx)("button",{onClick:function(){l({variables:{userId:o.id,eventId:t.id}}),n("you're NO LONGER going to ".concat(t.title),"navbar-error")},className:"button leave-button",children:"LEAVE"}):Object(W.jsx)("button",{onClick:function(){i({variables:{userId:o.id,eventId:t.id}}),n("you're going to ".concat(t.title),"navbar-success")},className:"button join-button",children:"JOIN"}):Object(W.jsx)("button",{disabled:!0,className:"button full-button",children:"FULL"}):null},V=function(e){var t=e.event,n=e.setNotify,c=new Date(t.eventDate);return Object(W.jsxs)("div",{children:[Object(W.jsxs)("div",{className:"event-info-top",children:[Object(W.jsx)(J.b,{to:"/events/".concat(t.id),children:Object(W.jsx)("p",{style:{fontSize:"60px"},children:t.title})}),Object(W.jsx)("img",{src:t.host.pic,alt:"host",className:"event-host-pic"})]}),Object(W.jsx)("img",{src:t.eventPic,alt:"event",className:"event-pic"}),Object(W.jsxs)("div",{className:"event-info-bottom",children:[Object(W.jsx)("div",{children:t.eventType}),Object(W.jsx)("div",{children:t.location}),Object(W.jsxs)("div",{children:[Object(W.jsx)("div",{children:c.toLocaleDateString()}),Object(W.jsx)("div",{style:{textAlign:"center"},children:c.toLocaleTimeString().slice(0,5)})]})]}),Object(W.jsx)(K,{event:t,setNotify:n})]})},X=function(e){var t=e.events,n=e.token,c=e.setNotify;return Object(W.jsx)("div",{children:Object(W.jsx)("ul",{className:"events-container",children:null===t||void 0===t?void 0:t.map((function(e){return Object(W.jsx)("li",{className:"event",children:Object(W.jsx)(V,{event:e,token:n,setNotify:c})},e.id)}))})})},Z=function(e){var t=e.notification;return Object(W.jsx)("div",{className:"navbar",children:Object(W.jsx)("div",{className:t.type,children:t.message})})},_=function(e){var t=e.type,n=e.setType,c=(e.period,e.setPeriod),a=e.drinksArr,r=e.drinks,i=e.setDrinks,s=e.buttonClass,l=e.dateClass,o=e.drinksClass,d=e.checkBoxClass,j=new Date,u=new Date(j.getFullYear(),j.getMonth(),j.getDate()+1),b=Object(g.useState)("all"),v=Object(S.a)(b,2),O=v[0],h=v[1],x=function(e){t.includes(e)?n(t.filter((function(t){return t!==e}))):n(t.concat(e))},m={backgroundColor:"black",color:"whitesmoke"};return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)("div",{className:l,children:[Object(W.jsx)("button",{style:"all"===O?m:null,className:"filter-button "+s,value:null,onClick:function(e){var t=e.target;h("all"),c(t.value)},children:"ALL"}),Object(W.jsx)("button",{style:"today"===O?m:null,className:"filter-button "+s,onClick:function(){return h("today"),void c(u)},children:"Today"}),Object(W.jsx)("button",{className:"filter-button "+s,style:"week"===O?m:null,onClick:function(){!function(){var e=new Date(j.getFullYear(),j.getMonth(),j.getDate()+7);h("week"),c(e)}()},children:"This Week"})]}),Object(W.jsxs)("div",{className:d,children:[Object(W.jsxs)("label",{children:[Object(W.jsx)("input",{type:"checkbox",value:"Bar",checked:t.includes("Bar"),onChange:function(){return x("Bar")}}),"Bar"]}),Object(W.jsxs)("label",{children:[Object(W.jsx)("input",{type:"checkbox",value:"BYOB",checked:t.includes("BYOB"),onChange:function(){return x("BYOB")}}),"BYOB"]}),Object(W.jsxs)("label",{children:[Object(W.jsx)("input",{type:"checkbox",checked:t.includes("Club"),value:"Club",onChange:function(){return x("Club")}}),"Club"]})]}),Object(W.jsx)("div",{className:o,children:a.map((function(e){return Object(W.jsxs)("label",{children:[Object(W.jsx)("input",{type:"checkbox",value:e,checked:r.includes(e),onChange:function(e){var t,n=e.target;return t=n.value,void(r.includes(t)?i(r.filter((function(e){return e!==t}))):i(r.concat(t)))}}),e]},e)}))}),Object(W.jsx)("button",{className:"filter-button "+s,onClick:function(){return h("all"),c(null),n([]),void i([])},children:"Reset"})]})},ee=function(e){var t=e.login,n=e.signOut,c=e.token,a=e.notification,r=e.sortName,i=e.setSortName,s=e.type,l=e.setType,o=e.period,d=e.setPeriod,j=e.drinksArr,u=e.drinks,b=e.setDrinks,v=Object(g.useState)(!1),O=Object(S.a)(v,2),h=O[0],x=O[1],m=Object(g.useState)(!1),p=Object(S.a)(m,2),f=p[0],y=p[1],k=Object(g.useState)(!1),N=Object(S.a)(k,2),E=N[0],D=N[1],C=Object(g.useState)(""),w=Object(S.a)(C,2),I=w[0],$=w[1],B=Object(g.useState)(""),T=Object(S.a)(B,2),A=T[0],L=T[1],P=function(e){e.stopPropagation(),h?I&&A?(t({variables:{username:I,password:A}}),x(!1),$(""),L("")):x(!1):x(!0)},R=function(){var e=r.concat();e.push(e.shift()),i(e)};return a?Object(W.jsx)(Z,{notification:a}):Object(W.jsxs)("nav",{className:"navbar",children:[Object(W.jsxs)("div",{className:"navbar-container",children:[Object(W.jsx)("div",{onClick:function(){return x(!1)},children:Object(W.jsx)(J.b,{to:"/events",children:Object(W.jsx)("strong",{children:"DrANK"})})}),!c&&Object(W.jsx)("nav",{children:Object(W.jsxs)("ul",{children:[Object(W.jsx)("li",{onClick:P,children:"Sign In"}),Object(W.jsx)(J.b,{to:"/register",children:Object(W.jsx)("li",{onClick:function(){return x(!1)},children:" Sign Up"})})]})}),c&&Object(W.jsx)("nav",{children:Object(W.jsxs)("ul",{className:"nav-events-wrapper",children:[Object(W.jsx)(J.b,{to:"/events",children:Object(W.jsx)("li",{children:"Events"})}),Object(W.jsx)(J.b,{to:"/myevents",children:Object(W.jsx)("li",{children:"My Events"})}),Object(W.jsx)(J.b,{to:"/createevent",children:Object(W.jsx)("li",{children:"Create Event"})}),Object(W.jsx)("li",{onClick:function(){return R()},children:r[0]})]})}),c&&Object(W.jsx)("nav",{children:Object(W.jsx)("ul",{children:Object(W.jsx)("li",{onClick:n,children:"Sign Out"})})})]}),h&&Object(W.jsxs)("form",{className:h?"login-form":null,children:[Object(W.jsx)("div",{children:Object(W.jsx)("input",{value:I,placeholder:"username",onChange:function(e){var t=e.target;return $(t.value)}})}),Object(W.jsx)("div",{children:Object(W.jsx)("input",{value:A,placeholder:"password",onChange:function(e){var t=e.target;return L(t.value)},type:"password"})})]}),Object(W.jsxs)("div",{className:"navbar-collapsed navbar-collapsed-main",children:[Object(W.jsx)("div",{onClick:function(){return x(!1)},children:Object(W.jsx)(J.b,{to:"/events",children:Object(W.jsx)("strong",{children:"DrANK"})})}),!c&&Object(W.jsx)("nav",{children:Object(W.jsxs)("ul",{children:[Object(W.jsx)("li",{onClick:P,children:"Sign In"}),Object(W.jsx)(J.b,{to:"/register",children:Object(W.jsx)("li",{onClick:function(){return x(!1)},children:" Sign Up"})})]})}),c&&Object(W.jsx)("nav",{onClick:function(){D(!1),y(!f)},children:"EXPAND"})]}),f&&Object(W.jsxs)("ul",{className:f?"navbar-collapsed nav-collapsed-wrapper":null,children:[Object(W.jsx)(J.b,{to:"/events",children:Object(W.jsx)("li",{children:"Events"})}),Object(W.jsx)(J.b,{to:"/myevents",children:Object(W.jsx)("li",{children:"My Events"})}),Object(W.jsx)(J.b,{to:"/createevent",children:Object(W.jsx)("li",{children:"Create Event"})}),Object(W.jsx)("li",{onClick:function(){return R()},children:r[0]}),Object(W.jsx)(J.b,{to:"/profile",children:Object(W.jsx)("li",{children:"Profile"})}),Object(W.jsx)("li",{onClick:function(){return D(!E)},children:"Filter"}),Object(W.jsx)("li",{onClick:n,children:"Sign Out"})]}),E&&Object(W.jsxs)("div",{className:E?"navbar-collapsed nav-collapsed-filter":null,children:[Object(W.jsx)(_,{type:s,setType:l,period:o,setPeriod:d,drinksArr:j,drinks:u,setDrinks:b,buttonClass:"collapsed-filter-button",dateClass:"collapsed-filter-dates",checkBoxClass:"collapsed-filter-checkboxes",drinksClass:"collapsed-filter-drinks"}),Object(W.jsx)("button",{className:"collapsed-filter-button",onClick:function(){return D(!1)},children:"Done"})]})]})},te=n(100),ne=n(39),ce=new te.a({typePolicies:{Event:{fields:{attendees:{merge:!1}}},Query:{fields:{isLoggedIn:{read:function(){return ae()}},eventsArr:{read:function(){return re()}},eventsArrFilter:{read:function(){return ie()}},userData:{read:function(){return se()}},type:{read:function(){return le()}}}}}}),ae=Object(ne.c)(!!localStorage.getItem("user-token")),re=Object(ne.c)([]),ie=Object(ne.c)([]),se=Object(ne.c)({}),le=Object(ne.c)([]),oe=function(e){var t=e.addEvent,n=e.history,c=Object(g.useState)(""),a=Object(S.a)(c,2),r=a[0],i=a[1],s=Object(g.useState)("BYOB"),l=Object(S.a)(s,2),o=l[0],d=l[1],j=Object(g.useState)(void 0),u=Object(S.a)(j,2),b=u[0],v=u[1],O=Object(g.useState)(""),h=Object(S.a)(O,2),x=h[0],m=h[1],f=Object(g.useState)(""),y=Object(S.a)(f,2),k=y[0],N=y[1],E=Object(g.useState)(""),D=Object(S.a)(E,2),w=D[0],I=D[1],$=Object(g.useState)(!1),B=Object(S.a)($,2),T=B[0],A=B[1],L=Object(g.useState)(0),P=Object(S.a)(L,2),R=P[0],q=P[1];return Object(W.jsx)("div",{className:"create-event-container",children:Object(W.jsxs)("form",{onSubmit:function(e){e.preventDefault();var c=""===w?new Date:w,a={title:r,eventType:o,eventPic:b,location:x,description:k,eventDate:c,max:T,maxGuests:R};t({variables:a}),re([].concat(Object(C.a)(re()),[Object(p.a)(Object(p.a)({},a),{},{host:se(),attendees:[],id:Math.random(),eventPic:a.eventPic?a.eventPic:"https://images.unsplash.com/photo-1528495612343-9ca9f4a4de28?ixid=MnwxMjA3fDB8MHxzZWFyY2h8MTJ8fHBhcnR5fGVufDB8fDB8fA%3D%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=500&q=60"})])),i(""),d(""),v(""),m(""),N(""),I(""),q(0),n.push("/events")},className:"event-form",children:[Object(W.jsxs)("div",{className:"radio-buttons",children:[Object(W.jsxs)("label",{children:["BYOB",Object(W.jsx)("input",{value:"BYOB",type:"radio",name:"event type",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(W.jsxs)("label",{children:["Bar",Object(W.jsx)("input",{value:"Bar",type:"radio",name:"event type",onChange:function(e){var t=e.target;return d(t.value)}})]}),Object(W.jsxs)("label",{children:["Club",Object(W.jsx)("input",{value:"Club",type:"radio",name:"event type",onChange:function(e){var t=e.target;return d(t.value)}})]})]}),Object(W.jsx)("input",{value:r,placeholder:"Title",onChange:function(e){var t=e.target;return i(t.value)}}),Object(W.jsx)("input",{value:b,placeholder:"Pic",onChange:function(e){var t=e.target;return v(t.value)}}),Object(W.jsx)("input",{value:x,placeholder:"Location",onChange:function(e){var t=e.target;return m(t.value)}}),Object(W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(W.jsxs)("label",{children:["Max?",Object(W.jsx)("input",{type:"checkbox",checked:T,onChange:function(e){var t=e.target;return A(t.checked)}})]}),Object(W.jsx)("input",{style:T?{display:!0}:{display:"none"},value:R,type:"number",min:"0",onChange:function(e){var t=e.target;return q(parseInt(t.value))}})]}),Object(W.jsx)("input",{value:w,type:"datetime-local",onChange:function(e){var t=e.target;return I(t.value)}}),Object(W.jsx)("textarea",{value:k,placeholder:"How's it going to be?",onChange:function(e){var t=e.target;return N(t.value)}}),Object(W.jsx)("button",{className:"button",style:{alignSelf:"center"},type:"submit",children:"add Event"})]})})},de=function(){var e=Object(I.a)(M,{update:function(e,t){try{var n=e.readQuery({query:M});e.writeQuery({query:M,data:Object(p.a)(Object(p.a)({},n),{},{me:[].concat(Object(C.a)(n),[t.data.me])})})}catch(c){throw new Error("trouble in Profile component w/ User Data query")}}}),t=e.loading,n=e.error,c=e.data;return t?Object(W.jsx)("div",{children:"LOADING"}):n?Object(W.jsxs)("div",{children:["ERROR: ",n.message]}):c.me?Object(W.jsxs)("div",{className:"profile",children:[Object(W.jsx)("h3",{children:c.me.username}),Object(W.jsx)("img",{src:c.me.pic,alt:"profile pic",className:"profile-pic"}),Object(W.jsx)("div",{children:c.me.drink})]}):Object(W.jsx)("div",{children:"NO DATA"})},je=function(e){var t=e.createUser,n=(e.history,e.createResult,Object(g.useState)("")),c=Object(S.a)(n,2),a=c[0],r=c[1],i=Object(g.useState)(""),s=Object(S.a)(i,2),l=s[0],o=s[1],d=Object(g.useState)(""),j=Object(S.a)(d,2),u=j[0],b=j[1],v=Object(g.useState)(""),O=Object(S.a)(v,2),h=O[0],x=O[1];Object(g.useEffect)((function(){r(""),o(""),o(""),o("")}),[]);var m=function(){var e=Object(D.a)(E.a.mark((function e(n){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),t({variables:{username:a,password:l,pic:u,drink:h}});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(W.jsx)("div",{className:"create-event-container",children:Object(W.jsxs)("form",{className:"registration-form",onSubmit:m,children:[Object(W.jsx)("input",{value:a,placeholder:"username",required:!0,onChange:function(e){var t=e.target;return r(t.value)}}),Object(W.jsx)("input",{value:l,placeholder:"password",onChange:function(e){var t=e.target;return o(t.value)},required:!0,type:"password"}),Object(W.jsx)("input",{value:u,placeholder:"profile pic",onChange:function(e){var t=e.target;return b(t.value)}}),Object(W.jsx)("input",{value:h,placeholder:"drink of choice",required:!0,onChange:function(e){var t=e.target;return x(t.value)}}),Object(W.jsx)("button",{className:"button register-button",type:"submit",children:"Register"})]})})},ue=function(e){var t=e.event,n=(e.token,e.userInfo,new Date(t.eventDate)),c=new Date,a=n>=new Date(c.getFullYear(),c.getMonth(),c.getDate());return Object(W.jsxs)("div",{children:[Object(W.jsx)("div",{className:"event-info-top",children:Object(W.jsx)(J.b,{to:"/events/".concat(t.id),children:Object(W.jsx)("p",{style:{fontSize:"100px"},children:t.title})})}),Object(W.jsx)("img",{src:t.eventPic,alt:"event",className:"event-pic"}),Object(W.jsxs)("div",{className:"event-info-bottom",children:[Object(W.jsx)("div",{children:t.eventType}),Object(W.jsx)("div",{children:t.location}),Object(W.jsxs)("div",{children:[Object(W.jsx)("div",{children:n.toLocaleDateString()}),Object(W.jsx)("div",{style:{textAlign:"center"},children:n.toLocaleTimeString().slice(0,5)})]})]}),a&&Object(W.jsx)(J.b,{to:"/editevent/".concat(t.id),children:Object(W.jsx)("button",{className:"edit-button button",children:"EDIT"})})]})},be=function(e){var t,n=e.token,c=Object(I.a)(M),a=c.data,r=c.loading,i=c.error;if(r)return Object(W.jsx)("div",{children:"LOADING"});if(i)return Object(W.jsxs)("div",{children:["ERROR: ",i]});var s=a.me;return Object(W.jsx)("div",{children:Object(W.jsx)("ul",{className:"events-container",children:null===(t=s.myEvents)||void 0===t?void 0:t.map((function(e){return Object(W.jsx)("li",{className:"event",children:Object(W.jsx)(ue,{event:e,token:n,userInfo:s})},"myevent ".concat(e.id))}))})})},ve=function(e){e.token;var t=e.setNotify,n=Object(w.g)(),c=Object(w.h)().id,a=Object(I.a)(F,{variables:{eventId:c},fetchPolicy:"network-only",onCompleted:function(){O(s.findEvent.title),N(s.findEvent.eventPic),T(s.findEvent.location),p(s.findEvent.eventType),G(s.findEvent.description),V(s.findEvent.max);var e=s.findEvent.eventDate;H("".concat(e.slice(0,4),"-").concat(e.slice(5,7),"-").concat(e.slice(8,10),"T").concat(new Date(e).toLocaleTimeString().slice(0,5))),ee(s.findEvent.maxGuests)}}),r=a.loading,i=a.error,s=a.data,l=Object($.a)(R,{onError:function(e){t(e.message)},refetchQueries:[{query:L}]}),o=Object(S.a)(l,1)[0],d=Object($.a)(Q),j=Object(S.a)(d,1)[0],u=Object(g.useState)(""),b=Object(S.a)(u,2),v=b[0],O=b[1],h=Object(g.useState)(""),x=Object(S.a)(h,2),m=x[0],p=x[1],f=Object(g.useState)(""),y=Object(S.a)(f,2),k=y[0],N=y[1],E=Object(g.useState)(""),D=Object(S.a)(E,2),B=D[0],T=D[1],A=Object(g.useState)(""),P=Object(S.a)(A,2),q=P[0],G=P[1],U=Object(g.useState)(""),Y=Object(S.a)(U,2),M=Y[0],H=Y[1],z=Object(g.useState)(""),J=Object(S.a)(z,2),K=J[0],V=J[1],X=Object(g.useState)(0),Z=Object(S.a)(X,2),_=Z[0],ee=Z[1];if(r)return Object(W.jsx)("div",{children:"LOADING"});if(i)return Object(W.jsx)("div",{children:i});var te=s.findEvent;return Object(W.jsxs)("div",{className:"edit-event-container",children:[Object(W.jsxs)("div",{children:[Object(W.jsxs)("form",{onSubmit:function(e){e.preventDefault(),o({variables:{title:v,eventType:m,eventPic:k,location:B,description:q,eventDate:M,max:K,maxGuests:_,eventId:c}}),O(""),p(""),N(""),T(""),G(""),H(""),V(""),ee(0),n.push("/events")},className:"event-form",children:[Object(W.jsxs)("div",{className:"radio-buttons",children:[Object(W.jsxs)("label",{children:["BYOB",Object(W.jsx)("input",{value:"BYOB",type:"radio",name:"event type",checked:"BYOB"===m,onChange:function(e){var t=e.target;return p(t.value)}})]}),Object(W.jsxs)("label",{children:["Bar",Object(W.jsx)("input",{value:"Bar",type:"radio",name:"event type",checked:"Bar"===m,onChange:function(e){var t=e.target;return p(t.value)}})]}),Object(W.jsxs)("label",{children:["Club",Object(W.jsx)("input",{value:"Club",type:"radio",name:"event type",checked:"Club"===m,onChange:function(e){var t=e.target;return p(t.value)}})]})]}),Object(W.jsx)("input",{value:v,placeholder:"Title",onChange:function(e){var t=e.target;return O(t.value)}}),Object(W.jsx)("input",{value:k,placeholder:"Pic",onChange:function(e){var t=e.target;return N(t.value)}}),Object(W.jsx)("input",{value:B,placeholder:"Location",onChange:function(e){var t=e.target;return T(t.value)}}),Object(W.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[Object(W.jsxs)("label",{children:["Max?",Object(W.jsx)("input",{type:"checkbox",checked:K,onChange:function(e){var t=e.target;return V(t.checked)}})]}),Object(W.jsx)("input",{style:K?{display:"inline-block"}:{display:"none"},value:_,type:"number",min:"0",placeholder:"no limit",onChange:function(e){var t=e.target;ee(parseInt(t.value))}})]}),Object(W.jsx)("input",{value:M,type:"datetime-local",onChange:function(e){var t=e.target;return H(t.value)}}),Object(W.jsx)("textarea",{value:q,placeholder:"How's it going to be?",onChange:function(e){var t=e.target;return G(t.value)}}),Object(W.jsx)("button",{type:"submit",className:"button",style:{alignSelf:"center"},children:"Edit Event"})]}),Object(W.jsx)("button",{className:"button leave-button",style:{alignSelf:"center"},onClick:function(){return function(e){j({variables:{eventId:e}}),ce.evict({id:"Event:".concat(e)}),ce.gc(),re(Object(C.a)(re()).filter((function(t){return t.id!==e}))),n.push("/events")}(c)},children:"DELETE"})]}),Object(W.jsx)("img",{src:te.eventPic,className:"event-pic",alt:"event"})]})},Oe=function(e){e.setNotify;var t=e.event,n=e.going,c=Object(g.useState)(""),a=Object(S.a)(c,2),r=a[0],i=a[1],s=Object($.a)(z,{update:function(e,n){var c=e.readQuery({query:F,variables:{eventId:t.id}});e.writeQuery({query:F,variables:{eventId:t.id},data:Object(p.a)(Object(p.a)({},c),{},{findEvent:Object(p.a)(Object(p.a)({},c.findEvent),{},{comments:[].concat(Object(C.a)(c.findEvent.comments),[n.data.createComment])})})})}}),l=Object(S.a)(s,1)[0],o=t.comments;return Object(W.jsxs)("div",{children:[n&&Object(W.jsxs)("div",{className:"comment-form",children:[Object(W.jsx)("input",{value:r,placeholder:"comments",onChange:function(e){var t=e.target;return i(t.value)}}),Object(W.jsx)("button",{onClick:function(){r.length>0&&(l({variables:{comment:r,eventId:t.id}}),i(""))},children:"+"})]}),o.length>0&&Object(W.jsx)("ul",{children:o.map((function(e){return Object(W.jsxs)("li",{className:"comment",id:e.id,children:[Object(W.jsx)("img",{className:"comment-pic",alt:"comment-pic",src:e.author.pic}),Object(W.jsx)("p",{children:e.comment})]},e.id)}))})]})},he=function(e){e.token;var t=e.setNotify,n=Object(w.h)().id,c=Object(I.a)(F,{variables:{eventId:n}}),a=Object(I.a)(M);if(c.loading||a.loading)return Object(W.jsx)("div",{children:"LOADING"});if(c.error||a.error)return Object(W.jsxs)("div",{children:["ERROR"," ",c.error?c.error.message:a.error.message]});var r=c.data.findEvent,i=a.data.me;console.log(new Date(r.eventDate));var s=!r.attendees.every((function(e){return(null===e||void 0===e?void 0:e.id)!==(null===i||void 0===i?void 0:i.id)})),l=new Date(r.eventDate);return Object(W.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(W.jsxs)("div",{className:"event",children:[Object(W.jsx)("div",{className:"event-info-top",children:Object(W.jsx)("p",{style:{fontSize:"100px"},children:r.title})}),Object(W.jsx)("img",{src:r.eventPic,alt:"event",className:"event-pic"}),Object(W.jsxs)("div",{className:"event-info-bottom",children:[Object(W.jsx)("div",{children:r.eventType}),Object(W.jsx)("div",{children:r.location}),Object(W.jsxs)("div",{children:[Object(W.jsx)("div",{children:l.toLocaleDateString()}),Object(W.jsx)("div",{style:{textAlign:"center"},children:l.toLocaleTimeString().slice(0,5)})]})]}),Object(W.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(W.jsx)("div",{className:"event-description",children:r.description})}),Object(W.jsx)(K,{event:r,user:i,setNotify:t,going:s}),Object(W.jsx)(Oe,{going:s,event:r})]})})},xe=function(){var e=Object(w.h)().id,t=Object(g.useState)(null),n=Object(S.a)(t,2),c=n[0],a=n[1],r=Object(I.a)(F,{variables:{eventId:e}});if(r.loading)return Object(W.jsx)("div",{children:"LOADING"});if(r.error)return Object(W.jsx)("div",{children:"ERROR"});var i=r.data.findEvent;return c?Object(W.jsxs)("div",{className:"profile",children:[Object(W.jsx)("h3",{children:c.username}),Object(W.jsx)("img",{src:c.pic,alt:"profile pic",className:"profile-pic"}),Object(W.jsx)("div",{children:c.drink}),Object(W.jsx)("button",{className:"button filter-button",onClick:function(){return a(null)},children:"back"})]}):Object(W.jsx)("div",{children:Object(W.jsxs)("div",{className:"attendees-container",children:["People Going ",i.max&&Object(W.jsxs)("div",{children:["(max ",i.maxGuests,")"]}),Object(W.jsx)("ul",{children:i.attendees.map((function(e){return Object(W.jsx)("li",{children:Object(W.jsx)("img",{onClick:function(){return a(e)},src:e.pic,alt:e.username,className:"attendee-pic"})},e.id)}))})]})})},me=function(){var e=Object(w.h)().id,t=Object(I.a)(F,{variables:{eventId:e}}),n=Object(I.a)(M);if(t.loading||n.loading)return Object(W.jsx)("div",{children:"LOADING"});if(t.loading||n.loading)return Object(W.jsx)("div",{children:"ERROR"});var c=t.data.findEvent.host;return Object(W.jsxs)("div",{className:"profile",children:[Object(W.jsx)("div",{children:c.id===n.data.me.id?"You're hosting!":"hosted by:"}),Object(W.jsx)("h3",{children:c.username}),Object(W.jsx)("img",{src:c.pic,alt:"profile pic",className:"profile-pic"}),Object(W.jsx)("div",{children:c.drink})]})},pe=n(72),fe=["children","token"],ge=function(e){var t=e.children,n=e.token,c=Object(pe.a)(e,fe);return Object(W.jsx)(w.b,Object(p.a)(Object(p.a)({},c),{},{render:function(){return n?t:Object(W.jsx)(w.a,{to:"/register"})}}))},ye=n(97),ke=function(e,t){switch(t){case"Later":e.sort((function(e,t){return new Date(t.eventDate)-new Date(e.eventDate)}));break;case"Sooner":e.sort((function(e,t){return new Date(e.eventDate)-new Date(t.eventDate)}));break;case"Old":e.sort((function(e,t){return new Date(e.createdAt)-new Date(t.createdAt)}));break;case"New":e.sort((function(e,t){return new Date(t.createdAt)-new Date(e.createdAt)}));break;default:e.sort((function(e,t){return new Date(t.eventDate)-new Date(e.eventDate)}))}return e};var Ne,Ee=function(){var e=Object(I.a)(L,{onCompleted:function(e){e.allEvents}}),t=Object(I.a)(M,{onCompleted:function(e){var t=e.me;se(t)}}),n=Object(ye.a)(),c=Object(w.g)(),a=Object(g.useState)(null),r=Object(S.a)(a,2),i=r[0],s=r[1],l=Object(g.useState)(null),o=Object(S.a)(l,2),d=o[0],j=o[1],u=Object(g.useState)([]),b=Object(S.a)(u,2),v=b[0],O=b[1],h=Object(g.useState)(null),x=Object(S.a)(h,2),m=x[0],f=x[1],y=Object(g.useState)(null),k=Object(S.a)(y,2),N=k[0],B=k[1],T=Object(g.useState)([]),A=Object(S.a)(T,2),R=A[0],q=A[1],G=Object(g.useState)(["Sort","New","Old","Sooner","Later"]),F=Object(S.a)(G,2),Q=F[0],H=F[1],z=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"navbar-error";clearTimeout(N),j({message:e,type:t});var n=setTimeout((function(){return j(null)}),2500);B(n)},J=Object($.a)(U,{onCompleted:function(e){var n=e.createUser;localStorage.setItem("user-token",n.value),s(n.value),ae(!0),c.push("/events"),z("Welcome to dRank!","navbar-success"),t.refetch(),se(n.user)},update:function(e,t){try{var n=e.readQuery({query:M});e.writeQuery({query:M,data:Object(p.a)(Object(p.a)({},n),{},{me:t.data.createUser.user})})}catch(c){throw new Error("error from App.js trying to write to Cache from createUser",c.message)}},onError:function(e){z(e.message),console.log("error from createUser mutation in App.js",e)}}),K=Object(S.a)(J,2),V=K[0],Z=K[1],te=Object($.a)(Y,{onCompleted:function(e){var t=e.login;t&&(localStorage.setItem("user-token",t.value),s(t.value),ae(!0),c.push("/events"),z("Welcome ".concat(t.user.username,"!"),"navbar-success"),console.log(t.user),se(t.user))},onError:function(e){z(e.message),console.log("error from LOGIN mutation in App.js",e)},update:function(e,t){try{var n=e.readQuery({query:M});e.writeQuery({query:M,data:Object(p.a)(Object(p.a)({},n),{},{me:t.data.login.user})})}catch(c){throw new Error("error from App.js trying to write to Cache from createUser",c.message)}}}),ne=Object(S.a)(te,2),ce=ne[0],re=ne[1],ie=Object($.a)(P,{refetchQueries:[{query:L}],onError:function(e){z(e.message),setTimeout((function(){return j(null)}),2e3),console.log(e)},onCompleted:function(e){var t=e.addEvent;z("".concat(t.title," is happening!"),"navbar-success")},update:function(e,t){var n=e.readQuery({query:M});e.writeQuery({query:M,data:Object(p.a)(Object(p.a)({},n),{},{me:Object(p.a)(Object(p.a)({},n.me),{},{myEvents:[].concat(Object(C.a)(n.me.myEvents),[t.data.addEvent])})})})}}),le=Object(S.a)(ie,1)[0];Object(g.useEffect)((function(){var e=localStorage.getItem("user-token");e&&s(e)}),[]),Object(g.useEffect)((function(){re.data&&(localStorage.setItem("user-token",re.data.login.value),s(re.data.login.value))}),[re.data]);var ue=function(){var e=Object(D.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return localStorage.clear(),s(null),c.push("/"),e.next=5,n.resetStore();case 5:return e.abrupt("return",ae(!1));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(e.error||re.error)return Object(W.jsx)("div",{children:"ERROR "});if(e.loading||re.loading)return Object(W.jsx)("div",{children:"LOADING "});var Oe=e.data.allEvents.reduce((function(e,t){return e.includes(t.host.drink)?e:e.concat(t.host.drink)}),[]),pe=function(e,t,n,c,a){var r=t.length?e.filter((function(e){return t.includes(e.eventType)})):e,i=new Date,s=new Date(i.getFullYear(),i.getMonth(),i.getDate()),l=n?r.filter((function(e){return new Date(e.eventDate)>=s})).filter((function(e){return new Date(n)-new Date(e.eventDate)>=0})):r,o=c.length?l.filter((function(e){return c.includes(e.host.drink)})):l,d=Object(C.a)(o);return ke(d,a)}(e.data.allEvents,v,m,R,Q[0]);return Object(W.jsxs)("div",{children:[Object(W.jsx)(ee,{login:ce,token:i,signOut:ue,notification:d,sortName:Q,setSortName:H,type:v,setType:O,period:m,setPeriod:f,drinksArr:Oe,drinks:R,setDrinks:q}),Object(W.jsxs)("div",{className:"main-container",children:[Object(W.jsx)("div",{className:"main",children:Object(W.jsxs)(w.d,{children:[Object(W.jsx)(ge,{path:"/createevent",token:i,children:Object(W.jsx)(oe,{addEvent:le,history:c,setNotify:z})}),Object(W.jsx)(ge,{path:"/editevent/:id",token:i,children:Object(W.jsx)(ve,{history:c,setNotify:z})}),Object(W.jsx)(ge,{path:"/myevents",token:i,children:Object(W.jsx)(be,{})}),Object(W.jsx)(ge,{path:"/events/:id",token:i,children:Object(W.jsx)(he,{setNotify:z})}),Object(W.jsx)(w.b,{path:"/register",children:Object(W.jsx)(je,{createUser:V,createResult:Z,history:c})}),Object(W.jsx)(w.b,{path:"/events",children:Object(W.jsx)(X,{events:pe,setNotify:z})}),Object(W.jsx)(w.b,{path:"/",children:Object(W.jsx)("h1",{children:"SOMETHING HERE"})})]})}),Object(W.jsx)("aside",{className:"aside aside-1",children:i&&Object(W.jsxs)(w.d,{children:[Object(W.jsx)(w.b,{path:"/events/:id",children:Object(W.jsx)(xe,{})}),Object(W.jsx)(w.b,{path:"/events",children:Object(W.jsx)(_,{type:v,setType:O,period:m,setPeriod:f,drinksArr:Oe,drinks:R,setDrinks:q,buttonClass:"button",dateClass:"filter-dates",checkBoxClass:"filter-checkboxes",drinksClass:"filter-drinks"})})]})}),Object(W.jsx)("aside",{className:"aside aside-2",children:i&&Object(W.jsxs)(w.d,{children:[Object(W.jsx)(w.b,{path:"/events/:id",children:Object(W.jsx)(me,{})}),Object(W.jsx)(w.b,{path:"/",children:Object(W.jsx)(de,{})})]})})]}),Object(W.jsx)("footer",{className:"footer"})]})},De=n(71),Ce=n(99),Se=n(98),we=n(70),Ie=Object(De.a)({uri:"https://cryptic-castle-61073.herokuapp.com/"}),$e=Object(B.a)(Ne||(Ne=Object(f.a)(["\n  extend type Query {\n    isLoggedIn: Boolean!\n  }\n"]))),Be=Object(we.a)((function(e,t){var n=t.headers,c=localStorage.getItem("user-token");return{headers:Object(p.a)(Object(p.a)({},n),{},{authorization:c?"bearer ".concat(c):null})}})),Te=new Ce.a({link:Be.concat(Ie),cache:ce,typeDefs:$e});k.a.render(Object(W.jsx)(Se.a,{client:Te,children:Object(W.jsx)(J.a,{children:Object(W.jsx)(Ee,{})})}),document.getElementById("root"))}},[[90,1,2]]]);
//# sourceMappingURL=main.8421aee3.chunk.js.map